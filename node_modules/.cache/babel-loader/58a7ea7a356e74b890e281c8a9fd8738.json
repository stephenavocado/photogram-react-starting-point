{"ast":null,"code":"import _toConsumableArray from\"/workspace/photogram-react-starting-point/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/workspace/photogram-react-starting-point/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/workspace/photogram-react-starting-point/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";export var FeedContext=/*#__PURE__*/createContext();export var FeedContextProvider=function FeedContextProvider(_ref){var children=_ref.children;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),feed=_useState2[0],setFeed=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loaded=_useState4[0],setLoaded=_useState4[1];function getFeedAxios(userId){axios.get(\"https://adm-photogram.herokuapp.com/api/v1/users/\".concat(userId,\".json?include=feed.likes\")).then(function(response){setFeed(response.data.data.feed);setLoaded(true);});}function getFeed(userId){var url=\"https://adm-photogram.herokuapp.com/api/v1/users/\".concat(userId,\".json?include=feed.likes\");var options={method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json;charset=UTF-8\"}};fetch(url,options).then(function(response){return response.json();}).then(function(data){//console.log(data.data.feed);\nsetFeed(data.data.feed);setLoaded(true);});}function like(postId,userId){var url=\"https://adm-photogram.herokuapp.com/api/v1/likes\";var options={method:\"POST\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json;charset=UTF-8\"},body:JSON.stringify({\"data\":{\"type\":\"likes\",\"attributes\":{\"fan_id\":userId,\"photo_id\":postId}}})};fetch(url,options).then(function(response){return response.json();}).then(function(data){setFeed(function(prevFeed){return prevFeed.map(function(photo){return photo.id===postId?_objectSpread(_objectSpread({},photo),{},{likes:[].concat(_toConsumableArray(photo.likes),[data])}):photo;});});console.log(data);});}return/*#__PURE__*/_jsx(FeedContext.Provider,{value:{feed:feed,getFeed:getFeed,loaded:loaded,like:like},children:children});};","map":{"version":3,"names":["React","createContext","useEffect","useState","axios","FeedContext","FeedContextProvider","children","feed","setFeed","loaded","setLoaded","getFeedAxios","userId","get","then","response","data","getFeed","url","options","method","headers","Accept","fetch","json","like","postId","body","JSON","stringify","prevFeed","map","photo","id","likes","console","log"],"sources":["/workspace/photogram-react-starting-point/src/services/feed/feed.context.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nexport const FeedContext = createContext();\n\nexport const FeedContextProvider = ({ children }) => {\n    const [feed, setFeed] = useState({});\n    const [loaded, setLoaded] = useState(false);\n\n    function getFeedAxios(userId) {\n        axios.get(`https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`)\n        .then(response => {\n            setFeed(response.data.data.feed); \n            setLoaded(true);\n        });\n    }\n\n    function getFeed(userId) {\n        const url = `https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`;\n        const options = {\n            method: \"GET\",\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json;charset=UTF-8\",\n            }\n        };\n        fetch(url, options)\n            .then((response) => response.json())\n            .then((data) => {\n                //console.log(data.data.feed);\n                setFeed(data.data.feed); \n                setLoaded(true);\n            });\n\n    }\n \n    function like(postId, userId) {\n        const url = \"https://adm-photogram.herokuapp.com/api/v1/likes\";\n        const options = {\n            method: \"POST\",\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json;charset=UTF-8\",\n            },\n            body: JSON.stringify({\n                \"data\": {\n                \"type\": \"likes\",\n                \"attributes\": {\n                    \"fan_id\": userId,\n                    \"photo_id\": postId \n                }}   \n            })\n        };\n        fetch(url, options)\n            .then((response) => response.json())\n            .then((data) => {\n                setFeed(prevFeed => prevFeed.map(photo => photo.id === postId ?\n                    {\n                        ...photo,\n                        likes: [...photo.likes, data]\n                    }\n                    :\n                    photo\n                    )\n                )\n                console.log(data);\n            })\n    }\n    \n    return (\n        <FeedContext.Provider\n            value={{\n                feed,\n                getFeed,\n                loaded,\n                like\n            }}\n        >\n            {children}\n        </FeedContext.Provider>        \n    );\n};"],"mappings":"oYAAA,MAAOA,MAAP,EAAgBC,aAAhB,CAA+BC,SAA/B,CAA0CC,QAA1C,KAA0D,OAA1D,CACA,MAAOC,MAAP,KAAkB,OAAlB,C,2CAEA,MAAO,IAAMC,YAAW,cAAGJ,aAAa,EAAjC,CAEP,MAAO,IAAMK,oBAAmB,CAAG,QAAtBA,oBAAsB,MAAkB,IAAfC,SAAe,MAAfA,QAAe,CACjD,cAAwBJ,QAAQ,CAAC,EAAD,CAAhC,wCAAOK,IAAP,eAAaC,OAAb,eACA,eAA4BN,QAAQ,CAAC,KAAD,CAApC,yCAAOO,MAAP,eAAeC,SAAf,eAEA,QAASC,aAAT,CAAsBC,MAAtB,CAA8B,CAC1BT,KAAK,CAACU,GAAN,4DAA8DD,MAA9D,8BACCE,IADD,CACM,SAAAC,QAAQ,CAAI,CACdP,OAAO,CAACO,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBT,IAApB,CAAP,CACAG,SAAS,CAAC,IAAD,CAAT,CACH,CAJD,EAKH,CAED,QAASO,QAAT,CAAiBL,MAAjB,CAAyB,CACrB,GAAMM,IAAG,4DAAuDN,MAAvD,4BAAT,CACA,GAAMO,QAAO,CAAG,CACZC,MAAM,CAAE,KADI,CAEZC,OAAO,CAAE,CACLC,MAAM,CAAE,kBADH,CAEL,eAAgB,gCAFX,CAFG,CAAhB,CAOAC,KAAK,CAACL,GAAD,CAAMC,OAAN,CAAL,CACKL,IADL,CACU,SAACC,QAAD,QAAcA,SAAQ,CAACS,IAAT,EAAd,EADV,EAEKV,IAFL,CAEU,SAACE,IAAD,CAAU,CACZ;AACAR,OAAO,CAACQ,IAAI,CAACA,IAAL,CAAUT,IAAX,CAAP,CACAG,SAAS,CAAC,IAAD,CAAT,CACH,CANL,EAQH,CAED,QAASe,KAAT,CAAcC,MAAd,CAAsBd,MAAtB,CAA8B,CAC1B,GAAMM,IAAG,CAAG,kDAAZ,CACA,GAAMC,QAAO,CAAG,CACZC,MAAM,CAAE,MADI,CAEZC,OAAO,CAAE,CACLC,MAAM,CAAE,kBADH,CAEL,eAAgB,gCAFX,CAFG,CAMZK,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjB,OAAQ,CACR,OAAQ,OADA,CAER,aAAc,CACV,SAAUjB,MADA,CAEV,WAAYc,MAFF,CAFN,CADS,CAAf,CANM,CAAhB,CAeAH,KAAK,CAACL,GAAD,CAAMC,OAAN,CAAL,CACKL,IADL,CACU,SAACC,QAAD,QAAcA,SAAQ,CAACS,IAAT,EAAd,EADV,EAEKV,IAFL,CAEU,SAACE,IAAD,CAAU,CACZR,OAAO,CAAC,SAAAsB,QAAQ,QAAIA,SAAQ,CAACC,GAAT,CAAa,SAAAC,KAAK,QAAIA,MAAK,CAACC,EAAN,GAAaP,MAAb,gCAE/BM,KAF+B,MAGlCE,KAAK,8BAAMF,KAAK,CAACE,KAAZ,GAAmBlB,IAAnB,EAH6B,GAMtCgB,KANkC,EAAlB,CAAJ,EAAT,CAAP,CASAG,OAAO,CAACC,GAAR,CAAYpB,IAAZ,EACH,CAbL,EAcH,CAED,mBACI,KAAC,WAAD,CAAa,QAAb,EACI,KAAK,CAAE,CACHT,IAAI,CAAJA,IADG,CAEHU,OAAO,CAAPA,OAFG,CAGHR,MAAM,CAANA,MAHG,CAIHgB,IAAI,CAAJA,IAJG,CADX,UAQKnB,QARL,EADJ,CAYH,CA5EM"},"metadata":{},"sourceType":"module"}
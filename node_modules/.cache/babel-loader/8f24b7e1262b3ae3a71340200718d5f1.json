{"ast":null,"code":"var _jsxFileName = \"/workspace/photogram-react-starting-point/src/services/feed/feed.context.js\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const FeedContext = /*#__PURE__*/createContext();\nexport const FeedContextProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [feed, setFeed] = useState({});\n  const [loaded, setLoaded] = useState(false);\n\n  function getFeedAxios(userId) {\n    axios.get(`https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`).then(response => {\n      setFeed(response.data.data.feed);\n      setLoaded(true);\n    });\n  }\n\n  function getFeed(userId) {\n    const url = `https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`;\n    const options = {\n      method: \"GET\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json;charset=UTF-8\"\n      }\n    };\n    fetch(url, options).then(response => response.json()).then(data => {\n      //console.log(data.data.feed);\n      setFeed(data.data.feed);\n      setLoaded(true);\n    });\n  }\n\n  function like(postId, userId) {\n    const url = \"https://adm-photogram.herokuapp.com/api/v1/likes\";\n    const options = {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json;charset=UTF-8\"\n      },\n      body: JSON.stringify({\n        \"data\": {\n          \"type\": \"likes\",\n          \"attributes\": {\n            \"fan_id\": userId,\n            \"photo_id\": postId\n          }\n        }\n      })\n    };\n    fetch(url, options).then(response => response.json()).then(data => {\n      setFeed(prevFeed => prevFeed.map(photo => photo.id === postId ? { ...photo,\n        likes: [...photo.likes, data]\n      } : photo));\n      console.log(data);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(FeedContext.Provider, {\n    value: {\n      feed,\n      getFeed,\n      loaded,\n      like\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n};\n\n_s(FeedContextProvider, \"+/xMGgosTEz416FKMNtSNB0gJmw=\");\n\n_c = FeedContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"FeedContextProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","axios","FeedContext","FeedContextProvider","children","feed","setFeed","loaded","setLoaded","getFeedAxios","userId","get","then","response","data","getFeed","url","options","method","headers","Accept","fetch","json","like","postId","body","JSON","stringify","prevFeed","map","photo","id","likes","console","log"],"sources":["/workspace/photogram-react-starting-point/src/services/feed/feed.context.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nexport const FeedContext = createContext();\n\nexport const FeedContextProvider = ({ children }) => {\n    const [feed, setFeed] = useState({});\n    const [loaded, setLoaded] = useState(false);\n\n    function getFeedAxios(userId) {\n        axios.get(`https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`)\n        .then(response => {\n            setFeed(response.data.data.feed); \n            setLoaded(true);\n        });\n    }\n\n    function getFeed(userId) {\n        const url = `https://adm-photogram.herokuapp.com/api/v1/users/${userId}.json?include=feed.likes`;\n        const options = {\n            method: \"GET\",\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json;charset=UTF-8\",\n            }\n        };\n        fetch(url, options)\n            .then((response) => response.json())\n            .then((data) => {\n                //console.log(data.data.feed);\n                setFeed(data.data.feed); \n                setLoaded(true);\n            });\n\n    }\n \n    function like(postId, userId) {\n        const url = \"https://adm-photogram.herokuapp.com/api/v1/likes\";\n        const options = {\n            method: \"POST\",\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json;charset=UTF-8\",\n            },\n            body: JSON.stringify({\n                \"data\": {\n                \"type\": \"likes\",\n                \"attributes\": {\n                    \"fan_id\": userId,\n                    \"photo_id\": postId \n                }}   \n            })\n        };\n        fetch(url, options)\n            .then((response) => response.json())\n            .then((data) => {\n                setFeed(prevFeed => prevFeed.map(photo => photo.id === postId ?\n                    {\n                        ...photo,\n                        likes: [...photo.likes, data]\n                    }\n                    :\n                    photo\n                    )\n                )\n                console.log(data);\n            })\n    }\n    \n    return (\n        <FeedContext.Provider\n            value={{\n                feed,\n                getFeed,\n                loaded,\n                like\n            }}\n        >\n            {children}\n        </FeedContext.Provider>        \n    );\n};"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,SAA/B,EAA0CC,QAA1C,QAA0D,OAA1D;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,OAAO,MAAMC,WAAW,gBAAGJ,aAAa,EAAjC;AAEP,OAAO,MAAMK,mBAAmB,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EACjD,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBN,QAAQ,CAAC,EAAD,CAAhC;EACA,MAAM,CAACO,MAAD,EAASC,SAAT,IAAsBR,QAAQ,CAAC,KAAD,CAApC;;EAEA,SAASS,YAAT,CAAsBC,MAAtB,EAA8B;IAC1BT,KAAK,CAACU,GAAN,CAAW,oDAAmDD,MAAO,0BAArE,EACCE,IADD,CACMC,QAAQ,IAAI;MACdP,OAAO,CAACO,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBT,IAApB,CAAP;MACAG,SAAS,CAAC,IAAD,CAAT;IACH,CAJD;EAKH;;EAED,SAASO,OAAT,CAAiBL,MAAjB,EAAyB;IACrB,MAAMM,GAAG,GAAI,oDAAmDN,MAAO,0BAAvE;IACA,MAAMO,OAAO,GAAG;MACZC,MAAM,EAAE,KADI;MAEZC,OAAO,EAAE;QACLC,MAAM,EAAE,kBADH;QAEL,gBAAgB;MAFX;IAFG,CAAhB;IAOAC,KAAK,CAACL,GAAD,EAAMC,OAAN,CAAL,CACKL,IADL,CACWC,QAAD,IAAcA,QAAQ,CAACS,IAAT,EADxB,EAEKV,IAFL,CAEWE,IAAD,IAAU;MACZ;MACAR,OAAO,CAACQ,IAAI,CAACA,IAAL,CAAUT,IAAX,CAAP;MACAG,SAAS,CAAC,IAAD,CAAT;IACH,CANL;EAQH;;EAED,SAASe,IAAT,CAAcC,MAAd,EAAsBd,MAAtB,EAA8B;IAC1B,MAAMM,GAAG,GAAG,kDAAZ;IACA,MAAMC,OAAO,GAAG;MACZC,MAAM,EAAE,MADI;MAEZC,OAAO,EAAE;QACLC,MAAM,EAAE,kBADH;QAEL,gBAAgB;MAFX,CAFG;MAMZK,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;QACjB,QAAQ;UACR,QAAQ,OADA;UAER,cAAc;YACV,UAAUjB,MADA;YAEV,YAAYc;UAFF;QAFN;MADS,CAAf;IANM,CAAhB;IAeAH,KAAK,CAACL,GAAD,EAAMC,OAAN,CAAL,CACKL,IADL,CACWC,QAAD,IAAcA,QAAQ,CAACS,IAAT,EADxB,EAEKV,IAFL,CAEWE,IAAD,IAAU;MACZR,OAAO,CAACsB,QAAQ,IAAIA,QAAQ,CAACC,GAAT,CAAaC,KAAK,IAAIA,KAAK,CAACC,EAAN,KAAaP,MAAb,GACtC,EACI,GAAGM,KADP;QAEIE,KAAK,EAAE,CAAC,GAAGF,KAAK,CAACE,KAAV,EAAiBlB,IAAjB;MAFX,CADsC,GAMtCgB,KANgB,CAAb,CAAP;MASAG,OAAO,CAACC,GAAR,CAAYpB,IAAZ;IACH,CAbL;EAcH;;EAED,oBACI,QAAC,WAAD,CAAa,QAAb;IACI,KAAK,EAAE;MACHT,IADG;MAEHU,OAFG;MAGHR,MAHG;MAIHgB;IAJG,CADX;IAAA,UAQKnB;EARL;IAAA;IAAA;IAAA;EAAA,QADJ;AAYH,CA5EM;;GAAMD,mB;;KAAAA,mB"},"metadata":{},"sourceType":"module"}